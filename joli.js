if(void 0===Haravan)var Haravan={};Haravan.cultures=[{code:"vi-VN",thousands:",",decimal:".",numberdecimal:0,money_format:"{{amount}}"},{code:"en-US",thousands:",",decimal:".",numberdecimal:2,money_format:"{{amount}}"}],Haravan.getCulture=function(a){var r;for(n=0;n<Haravan.cultures.length;n++)if(Haravan.cultures[n].code==a){r=Haravan.cultures[n];break}return r||(r=Haravan.cultures[0]),r},Haravan.format=Haravan.getCulture(Haravan.culture),Haravan.money_format="{{amount}}",Haravan.each=function(a,r){for(var n=0;n<a.length;n++)r(a[n],n)},Haravan.map=function(a,r){for(var n=[],e=0;e<a.length;e++)n.push(r(a[e],e));return n},Haravan.arrayIncludes=function(a,r){for(var n=0;n<a.length;n++)if(a[n]==r)return!0;return!1},Haravan.uniq=function(a){for(var r=[],n=0;n<a.length;n++)Haravan.arrayIncludes(r,a[n])||r.push(a[n]);return r},Haravan.isDefined=function(a){return void 0!==a},Haravan.getClass=function(a){return Object.prototype.toString.call(a).slice(8,-1)},Haravan.extend=function(a,r){function n(){}n.prototype=r.prototype,a.prototype=new n,a.prototype.constructor=a,a.baseConstructor=r,a.superClass=r.prototype},Haravan.urlParam=function(a){var r=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search);return r&&decodeURIComponent(r[1].replace(/\+/g," "))};
// ---------------------------------------------------------------------------
// Haravan Product object
// JS representation of Product
// ---------------------------------------------------------------------------
Haravan.Product=function(t){Haravan.isDefined(t)&&this.update(t)},Haravan.Product.prototype.update=function(t){for(property in t)this[property]=t[property]},Haravan.Product.prototype.optionNames=function(){return"Array"==Haravan.getClass(this.options)?this.options:[]},Haravan.Product.prototype.optionValues=function(t){if(!Haravan.isDefined(this.variants))return null;var a=Haravan.map(this.variants,(function(a){var n="option"+(t+1);return null==a[n]?null:a[n]}));return null==a[0]?null:Haravan.uniq(a)},Haravan.Product.prototype.getVariant=function(t){var a=null;return t.length!=this.options.length||Haravan.each(this.variants,(function(n){for(var r=!0,o=0;o<t.length;o++){n["option"+(o+1)]!=t[o]&&(r=!1)}1!=r||(a=n)})),a},Haravan.Product.prototype.getVariantById=function(t){for(var a=0;a<this.variants.length;a++){var n=this.variants[a];if(t==n.id)return n}return null};
// ---------------------------------------------------------------------------
// Money format handler
// ---------------------------------------------------------------------------

function floatToString(a,r){var t=a.toFixed(r).toString();return t.replace(".",Haravan.decimal),t.match("^[."+Haravan.decimal+"]d+")?"0"+t:t}Haravan.formatMoney=function(a,r){"string"==typeof(a/=100)&&(a=a.replace(Haravan.format.thousands,""));var t="",e=/\{\{\s*(\w+)\s*\}\}/,o=r||this.money_format;function n(a){return a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+Haravan.format.thousands)}switch(o.match(e)[1]){case"amount":t=n(floatToString(a,Haravan.format.numberdecimal));break;case"amount_no_decimals":t=n(floatToString(a,0));break;case"amount_with_comma_separator":t=floatToString(a,Haravan.format.numberdecimal).replace(/\./,",");break;case"amount_no_decimals_with_comma_separator":t=n(floatToString(a,0)).replace(/\./,",")}return o.replace(e,t)};
// ---------------------------------------------------------------------------
// OptionSelectors(domid, options)
//
// ---------------------------------------------------------------------------
Haravan.OptionSelectors=function(t,e){return this.selectorDivClass="selector-wrapper",this.selectorClass="single-option-selector",this.variantIdFieldIdSuffix="-variant-id",this.variantIdField=null,this.historyState=null,this.selectors=[],this.domIdPrefix=t,this.product=new Haravan.Product(e.product),this.onVariantSelected=Haravan.isDefined(e.onVariantSelected)?e.onVariantSelected:function(){},this.replaceSelector(t),this.initDropdown(),e.enableHistoryState&&(this.historyState=new Haravan.OptionSelectors.HistoryState(this)),!0},Haravan.OptionSelectors.prototype.initDropdown=function(){var t={initialLoad:!0};if(!this.selectVariantFromDropdown(t)){var e=this;setTimeout((function(){e.selectVariantFromParams(t)||e.fireOnChangeForFirstDropdown.call(e,t)}))}},Haravan.OptionSelectors.prototype.fireOnChangeForFirstDropdown=function(t){!this.selectors&&!this.selectors.length&&this.selectors.length>0&&this.selectors[0].element.onchange(t)},Haravan.OptionSelectors.prototype.selectVariantFromParamsOrDropdown=function(t){this.selectVariantFromParams(t)||this.selectVariantFromDropdown(t)},Haravan.OptionSelectors.prototype.replaceSelector=function(t){var e=document.getElementById(t);if(null!=e){var r=e.parentNode;Haravan.each(this.buildSelectors(),(function(t){r.insertBefore(t,e)})),e.style.display="none",this.variantIdField=e}},Haravan.OptionSelectors.prototype.selectVariantFromDropdown=function(t){var e=document.getElementById(this.domIdPrefix);if(!e)return!1;if(null!=(e=e.querySelector("[selected]"))){var r=e.value;return this.selectVariant(r,t)}return!1},Haravan.OptionSelectors.prototype.selectVariantFromParams=function(t){var e=Haravan.urlParam("variant");return this.selectVariant(e,t)},Haravan.OptionSelectors.prototype.selectVariant=function(t,e){var r=this.product.getVariantById(t);if(null==r)return!1;for(var a=0;a<this.selectors.length;a++){var n=this.selectors[a].element,o=r[n.getAttribute("data-option")];null!=o&&this.optionExistInSelect(n,o)&&(n.value=o)}return"undefined"!=typeof jQuery?jQuery(this.selectors[0].element).trigger("change",e):this.selectors[0].element.onchange(e),!0},Haravan.OptionSelectors.prototype.optionExistInSelect=function(t,e){for(var r=0;r<t.options.length;r++)if(t.options[r].value==e)return!0},Haravan.OptionSelectors.prototype.insertSelectors=function(t,e){Haravan.isDefined(e)&&this.setMessageElement(e),this.domIdPrefix="product-"+this.product.id+"-variant-selector";var r=document.getElementById(t);if(!r)return!1;Haravan.each(this.buildSelectors(),(function(t){r.appendChild(t)}))},Haravan.OptionSelectors.prototype.buildSelectors=function(){for(var t=0;t<this.product.optionNames().length;t++){var e=new Haravan.SingleOptionSelector(this,t,this.product.optionNames()[t],this.product.optionValues(t));e.element.disabled=!1,this.selectors.push(e)}var r=this.selectorDivClass,a=this.product.optionNames();return Haravan.map(this.selectors,(function(t){var e=document.createElement("div");if(e.setAttribute("class",r),a.length>1){var n=document.createElement("label");n.htmlFor=t.element.id,n.innerHTML=t.name,e.appendChild(n)}return e.appendChild(t.element),e}))},Haravan.OptionSelectors.prototype.selectedValues=function(){for(var t=[],e=0;e<this.selectors.length;e++){var r=this.selectors[e].element.value;t.push(r)}return t},Haravan.OptionSelectors.prototype.updateSelectors=function(t,e){var r=this.selectedValues(),a=this.product.getVariant(r);a?(this.variantIdField.disabled=!1,this.variantIdField.value=a.id):this.variantIdField.disabled=!0,this.onVariantSelected(a,this,e),null!=this.historyState&&this.historyState.onVariantChange(a,this,e)},Haravan.OptionSelectorsFromDOM=function(t,e){var r=e.optionNames||[],a=e.priceFieldExists||!0,n=e.delimiter||"/",o=this.createProductFromSelector(t,r,a,n);e.product=o,Haravan.OptionSelectorsFromDOM.baseConstructor.call(this,t,e)},Haravan.extend(Haravan.OptionSelectorsFromDOM,Haravan.OptionSelectors),Haravan.OptionSelectorsFromDOM.prototype.createProductFromSelector=function(t,e,r,a){if(!Haravan.isDefined(r))r=!0;if(!Haravan.isDefined(a))a="/";var n=document.getElementById(t);if(!n)return!1;var o=n.childNodes,i=(n.parentNode,e.length),s=[];Haravan.each(o,(function(t,n){if(1==t.nodeType&&"option"==t.tagName.toLowerCase()){var o=t.innerHTML.split(new RegExp("\\s*\\"+a+"\\s*"));0==e.length&&(i=o.length-(r?1:0));var l=o.slice(0,i),c=r?o[i]:"",p=(t.getAttribute("value"),{available:!t.disabled,id:parseFloat(t.value),price:c,option1:l[0],option2:l[1],option3:l[2]});s.push(p)}}));var l={variants:s};if(0==e.length){l.options=[];for(var c=0;c<i;c++)l.options[c]="option "+(c+1)}else l.options=e;return l};

// ---------------------------------------------------------------------------
// SingleOptionSelector
// takes option name and values and creates a option selector from them
// ---------------------------------------------------------------------------
Haravan.SingleOptionSelector=function(e,t,i,n){if(this.multiSelector=e,this.values=n,this.index=t,this.name=i,this.element=document.createElement("select"),null!=this.values)for(var l=0;l<this.values.length;l++){var s=document.createElement("option");s.value=n[l],s.innerHTML=n[l],this.element.appendChild(s)}return this.element.setAttribute("class",this.multiSelector.selectorClass),this.element.setAttribute("data-option","option"+(t+1)),this.element.id=e.domIdPrefix+"-option-"+t,this.element.onchange=function(i,n){n=n||{},e.updateSelectors(t,n)},!0};

// ---------------------------------------------------------------------------
// Image.switchImage
// helps to switch variant images on variant selection
// ---------------------------------------------------------------------------
Haravan.Image={preload:function(e,r){for(var t=0;t<e.length;t++){var i=e[t];this.loadImage(this.getSizedImageUrl(i,r))}},loadImage:function(e){(new Image).src=e},switchImage:function(e,r,t){if(e){var i=this.imageSize(r.src),a=this.getSizedImageUrl(e.src,i);t?t(a,e,r):r.src=a}},imageSize:function(e){var r=e.match(/(1024x1024|2048x2048|pico|icon|thumb|small|compact|medium|large|grande)\./);return null!=r?r[1]:null},getSizedImageUrl:function(e,r){if(null==r)return e;if("master"==r)return this.removeProtocol(e);var t=e.match(/\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\?v=\d+)?/);if(null!=t){var i=e.split(t[0]),a=t[0];return this.removeProtocol(i[0]+"_"+r+a)}return null},removeProtocol:function(e){return e.replace(/http(s)?:/,"")}};

// ---------------------------------------------------------------------------
// Haravan.HistoryState
// Gets events from Push State
// ---------------------------------------------------------------------------
Haravan.OptionSelectors.HistoryState=function(t){this.browserSupports()&&this.register(t)},Haravan.OptionSelectors.HistoryState.prototype.register=function(t){window.addEventListener("popstate",(function(o){t.selectVariantFromParamsOrDropdown({popStateCall:!0})}))},Haravan.OptionSelectors.HistoryState.prototype.onVariantChange=function(t,o,r){this.browserSupports()&&(!t||r.initialLoad||r.popStateCall||window.history.pushState({},document.title,"?variant="+t.id))},Haravan.OptionSelectors.HistoryState.prototype.browserSupports=function(){return window.history&&window.history.pushState};